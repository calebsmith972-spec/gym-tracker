<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#000000">
    <title>NEXUS TRACKER | V12</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;500;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --neon-blue: #00f7ff;
            --neon-purple: #bc13fe;
            --neon-green: #0aff0a;
            --neon-yellow: #ffcc00;
            --panel-bg: rgba(10, 10, 15, 0.9);
            --input-bg: rgba(0, 0, 0, 0.6);
            --border-color: #333;
            --text-main: #e0e0e0;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            background-color: #000;
            color: var(--text-main);
            font-family: 'Rajdhani', sans-serif;
            margin: 0;
            padding: 0;
            padding-bottom: 100px;
            overflow-x: hidden;
        }

        /* --- BACKGROUND ANIMATION --- */
        .bg-animation {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; pointer-events: none;
            --c: #09f;
            background-color: #000;
            background-image: radial-gradient(4px 100px at 0px 235px, var(--c), #0000), radial-gradient(4px 100px at 300px 235px, var(--c), #0000), radial-gradient(1.5px 1.5px at 150px 117.5px, var(--c) 100%, #0000 150%), radial-gradient(4px 100px at 0px 252px, var(--c), #0000), radial-gradient(4px 100px at 300px 252px, var(--c), #0000), radial-gradient(1.5px 1.5px at 150px 126px, var(--c) 100%, #0000 150%), radial-gradient(4px 100px at 0px 150px, var(--c), #0000), radial-gradient(4px 100px at 300px 150px, var(--c), #0000), radial-gradient(1.5px 1.5px at 150px 75px, var(--c) 100%, #0000 150%), radial-gradient(4px 100px at 0px 253px, var(--c), #0000), radial-gradient(4px 100px at 300px 253px, var(--c), #0000), radial-gradient(1.5px 1.5px at 150px 126.5px, var(--c) 100%, #0000 150%), radial-gradient(4px 100px at 0px 204px, var(--c), #0000), radial-gradient(4px 100px at 300px 204px, var(--c), #0000), radial-gradient(1.5px 1.5px at 150px 102px, var(--c) 100%, #0000 150%), radial-gradient(4px 100px at 0px 134px, var(--c), #0000), radial-gradient(4px 100px at 300px 134px, var(--c), #0000), radial-gradient(1.5px 1.5px at 150px 67px, var(--c) 100%, #0000 150%), radial-gradient(4px 100px at 0px 179px, var(--c), #0000), radial-gradient(4px 100px at 300px 179px, var(--c), #0000), radial-gradient(1.5px 1.5px at 150px 89.5px, var(--c) 100%, #0000 150%), radial-gradient(4px 100px at 0px 299px, var(--c), #0000), radial-gradient(4px 100px at 300px 299px, var(--c), #0000), radial-gradient(1.5px 1.5px at 150px 149.5px, var(--c) 100%, #0000 150%), radial-gradient(4px 100px at 0px 215px, var(--c), #0000), radial-gradient(4px 100px at 300px 215px, var(--c), #0000), radial-gradient(1.5px 1.5px at 150px 107.5px, var(--c) 100%, #0000 150%), radial-gradient(4px 100px at 0px 281px, var(--c), #0000), radial-gradient(4px 100px at 300px 281px, var(--c), #0000), radial-gradient(1.5px 1.5px at 150px 140.5px, var(--c) 100%, #0000 150%), radial-gradient(4px 100px at 0px 158px, var(--c), #0000), radial-gradient(4px 100px at 300px 158px, var(--c), #0000), radial-gradient(1.5px 1.5px at 150px 79px, var(--c) 100%, #0000 150%), radial-gradient(4px 100px at 0px 210px, var(--c), #0000), radial-gradient(4px 100px at 300px 210px, var(--c), #0000), radial-gradient(1.5px 1.5px at 150px 105px, var(--c) 100%, #0000 150%);
            background-size: 300px 235px, 300px 235px, 300px 235px, 300px 252px, 300px 252px, 300px 252px, 300px 150px, 300px 150px, 300px 150px, 300px 253px, 300px 253px, 300px 253px, 300px 204px, 300px 204px, 300px 204px, 300px 134px, 300px 134px, 300px 134px, 300px 179px, 300px 179px, 300px 179px, 300px 299px, 300px 299px, 300px 299px, 300px 215px, 300px 215px, 300px 215px, 300px 281px, 300px 281px, 300px 281px, 300px 158px, 300px 158px, 300px 158px, 300px 210px, 300px 210px, 300px 210px;
            animation: hi 150s linear infinite;
        }
        .bg-animation::after { content: ""; position: absolute; inset: 0; z-index: 1; backdrop-filter: blur(1em) brightness(6); background-image: radial-gradient(circle at 50% 50%, #0000 0, #0000 2px, hsl(0 0 4%) 2px); background-size: 8px 8px; opacity: 0.5; }
        @keyframes hi { 0% { background-position: 0px 220px, 3px 220px, 151.5px 337.5px; } to { background-position: 0px 6800px, 3px 6800px, 151.5px 6917.5px; } }

        /* --- NAVBAR --- */
        nav.top-nav {
            background: rgba(0,0,0,0.9); border-bottom: 1px solid var(--border-color);
            padding: 0 20px; height: 70px;
            position: sticky; top: 0; z-index: 200; backdrop-filter: blur(10px);
            display: flex; justify-content: space-between; align-items: center;
        }
        .nav-brand { font-family: 'Orbitron', sans-serif; font-weight: 700; color: #fff; font-size: 1.4rem; }
        .nav-brand span { color: var(--neon-blue); }
        .nav-links-desktop { display: flex; gap: 15px; }
        .mobile-menu-btn { display: none; background: none; border: none; color: white; font-size: 1.5rem; cursor: pointer; }
        .mobile-dropdown { display: none; position: absolute; top: 70px; left: 0; width: 100%; background: rgba(10, 10, 15, 0.98); border-bottom: 1px solid var(--neon-blue); flex-direction: column; padding: 20px; gap: 15px; z-index: 199; }
        .mobile-dropdown.open { display: flex; animation: slideDown 0.3s ease; }
        @keyframes slideDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        @media (max-width: 768px) { .nav-links-desktop { display: none; } .mobile-menu-btn { display: block; } }

        /* GLITCH BUTTON */
        .glitch-btn { padding: 10px 25px; font-size: 0.9rem; border: none; border-radius: 5px; color: white; background-color: transparent; position: relative; font-family: 'Orbitron', sans-serif; cursor: pointer; width: 100%; }
        .glitch-btn::after { --move1: inset(50% 50% 50% 50%); --move2: inset(31% 0 40% 0); --move3: inset(39% 0 15% 0); --move4: inset(45% 0 40% 0); --move5: inset(45% 0 6% 0); --move6: inset(14% 0 61% 0); clip-path: var(--move1); content: attr(data-text); position: absolute; top: 0; left: 0; right: 0; bottom: 0; display: block; }
        .glitch-btn:hover::after, .glitch-btn.active::after { animation: glitch_4011 1s; text-shadow: 10 10px 10px black; animation-timing-function: steps(2, end); text-shadow: -3px -3px 0px #1df2f0, 3px 3px 0px #E94BE8; background-color: transparent; border: 2px solid rgb(0, 255, 213); }
        .glitch-btn:hover, .glitch-btn.active { text-shadow: -1px -1px 0px #1df2f0, 1px 1px 0px #E94BE8; background-color: transparent; border: 1px solid rgb(0, 255, 213); box-shadow: 0px 10px 10px -10px rgb(0, 255, 213); }
        @keyframes glitch_4011 { 0% { clip-path: var(--move1); transform: translate(0px,-10px); } 10% { clip-path: var(--move2); transform: translate(-10px,10px); } 100% { clip-path: var(--move1); transform: translate(0); } }

        /* --- SCROLLERS --- */
        .scroller-container { position: sticky; top: 70px; z-index: 100; background: rgba(5,5,5,0.9); backdrop-filter: blur(10px); border-bottom: 1px solid var(--border-color); }
        .week-nav { display: flex; overflow-x: auto; gap: 10px; padding: 10px 15px; scrollbar-width: none; border-bottom: 1px solid #222; }
        .week-btn { background: rgba(0,0,0,0.5); border: 1px solid #444; color: #888; padding: 6px 14px; border-radius: 20px; font-family: 'Orbitron', sans-serif; font-size: 0.75rem; white-space: nowrap; transition: 0.3s; display: flex; align-items: center; gap: 5px; }
        .week-btn.active { border-color: var(--neon-purple); color: var(--neon-purple); background: rgba(188, 19, 254, 0.2); box-shadow: 0 0 10px rgba(188,19,254,0.3); }
        .week-completed-icon { color: var(--neon-green); font-size: 0.8rem; display: none; }
        .week-btn.completed .week-completed-icon { display: inline-block; text-shadow: 0 0 5px var(--neon-green); }
        .day-nav { display: flex; justify-content: space-between; padding: 10px 15px; background: rgba(10,10,15,0.8); }
        .day-btn { background: transparent; border: none; color: #555; font-family: 'Orbitron', sans-serif; font-size: 0.9rem; padding: 5px; position: relative; cursor: pointer; }
        .day-btn.active { color: var(--neon-blue); font-weight: bold; }
        .day-btn.active::after { content: ''; position: absolute; bottom: -5px; left: 0; width: 100%; height: 2px; background: var(--neon-blue); box-shadow: 0 0 5px var(--neon-blue); }
        .day-btn.completed { color: var(--neon-green); }
        .day-btn.completed::after { background: var(--neon-green); box-shadow: 0 0 5px var(--neon-green); }

        .view-section { display: none; padding: 15px; max-width: 600px; margin: 0 auto; }
        .view-section.active-view { display: block; }
        
        /* --- CARDS & INPUTS --- */
        .meta-card { background: var(--panel-bg); border: 1px solid var(--border-color); border-radius: 8px; padding: 15px; margin-bottom: 20px; display: flex; flex-direction: column; gap: 10px; backdrop-filter: blur(5px); }
        .meta-row { display: flex; gap: 10px; }
        .meta-group { flex: 1; }
        .meta-group label { font-size: 0.75rem; color: var(--neon-blue); display: block; margin-bottom: 5px; font-family: 'Orbitron', sans-serif; }
        .meta-input { width: 100%; background: var(--input-bg); border: 1px solid #333; color: white; padding: 10px; border-radius: 4px; font-family: 'Rajdhani', sans-serif; font-size: 1rem; }
        .meta-input[type="date"] { color-scheme: dark; }

        .ex-card { background: var(--panel-bg); border-left: 3px solid var(--neon-blue); border-radius: 6px; padding: 15px; margin-bottom: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.5); backdrop-filter: blur(5px); }
        .ex-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 10px; }
        .ex-title { font-size: 1.1rem; font-weight: 700; color: #fff; line-height: 1.2; }
        .rest-badge { background: rgba(0, 247, 255, 0.1); color: var(--neon-blue); padding: 4px 8px; border-radius: 4px; font-size: 0.75rem; font-family: 'Orbitron', sans-serif; white-space: nowrap; margin-left: 10px; }
        .ex-details { display: flex; gap: 15px; margin-bottom: 12px; font-size: 0.9rem; color: #888; border-bottom: 1px solid #222; padding-bottom: 8px; }
        .detail-item i { color: var(--neon-purple); margin-right: 5px; }
        .ex-notes-area { border-top: 1px solid #222; margin-top: 15px; padding-top: 10px; }
        .ex-notes-static { font-size: 0.8rem; color: #666; font-style: italic; margin-bottom: 8px; }
        .user-ex-note { width: 100%; background: transparent; border: none; border-bottom: 1px solid #444; color: #aaa; font-family: 'Rajdhani', sans-serif; font-size: 0.9rem; padding: 5px 0; transition: 0.3s; }
        .user-ex-note:focus { outline: none; border-bottom-color: var(--neon-blue); color: white; }

        .warmup-section { background: rgba(255, 204, 0, 0.05); border: 1px dashed var(--neon-yellow); border-radius: 4px; padding: 10px; margin-bottom: 15px; }
        .warmup-header { font-size: 0.75rem; color: var(--neon-yellow); font-family: 'Orbitron', sans-serif; margin-bottom: 5px; }
        .sets-grid { display: flex; flex-wrap: wrap; gap: 8px; }
        .set-input-group { flex: 1; min-width: 70px; display: flex; flex-direction: column; }
        .set-input-group label { font-size: 0.7rem; color: #555; margin-bottom: 2px; text-align: center; }
        .weight-input { background: #000; border: 1px solid #444; color: var(--neon-green); padding: 8px; border-radius: 4px; width: 100%; font-size: 1rem; font-family: 'Orbitron', sans-serif; text-align: center; }
        .weight-input.warmup { color: var(--neon-yellow); border-color: #554400; }

        .goals-card { background: var(--panel-bg); border: 1px solid var(--neon-purple); border-radius: 8px; padding: 15px; margin-bottom: 20px; display: flex; justify-content: space-between; backdrop-filter: blur(5px); box-shadow: 0 0 10px rgba(188, 19, 254, 0.2); }
        .goal-item { display: flex; flex-direction: column; align-items: center; gap: 5px; flex: 1; text-align: center; }
        .goal-icon { font-size: 1.5rem; color: var(--neon-blue); margin-bottom: 5px; }
        .goal-label { font-size: 0.6rem; color: #aaa; font-family: 'Orbitron', sans-serif; letter-spacing: 1px; }
        .goal-checkbox { appearance: none; width: 25px; height: 25px; border: 2px solid #444; border-radius: 4px; background: rgba(0,0,0,0.5); cursor: pointer; position: relative; }
        .goal-checkbox:checked { background: var(--neon-green); border-color: var(--neon-green); box-shadow: 0 0 10px var(--neon-green); }
        .goal-checkbox:checked::after { content: 'âœ“'; position: absolute; color: black; font-weight: bold; font-size: 16px; top: -2px; left: 4px; }

        /* --- CALENDAR & JOURNAL --- */
        .journal-container { display: flex; flex-direction: column; gap: 20px; }
        .calendar-wrapper { background: var(--panel-bg); border: 1px solid var(--neon-blue); border-radius: 8px; padding: 15px; backdrop-filter: blur(5px); }
        .calendar-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; font-family: 'Orbitron', sans-serif; color: var(--neon-blue); }
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px; }
        .cal-day-label { text-align: center; font-size: 0.7rem; color: #666; margin-bottom: 5px; }
        .cal-day { aspect-ratio: 1; display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.05); border-radius: 4px; cursor: pointer; font-size: 0.9rem; position: relative; transition: 0.2s; }
        .cal-day:hover { background: rgba(0, 247, 255, 0.2); }
        .cal-day.selected { border: 1px solid var(--neon-blue); background: rgba(0, 247, 255, 0.1); box-shadow: 0 0 5px var(--neon-blue); color: #fff; }
        .cal-day.has-entry::after { content: ''; position: absolute; bottom: 4px; width: 4px; height: 4px; background: var(--neon-purple); border-radius: 50%; box-shadow: 0 0 4px var(--neon-purple); }
        .cal-day.empty { background: transparent; cursor: default; }
        .selected-date-display { text-align: center; font-family: 'Orbitron', sans-serif; color: white; margin: 10px 0; font-size: 1.1rem; }

        .entry-list { display: flex; flex-direction: column-reverse; gap: 15px; max-height: 400px; overflow-y: auto; }
        .journal-entry { background: rgba(14,14,18,0.9); border-left: 2px solid var(--neon-purple); padding: 15px; border-radius: 0 8px 8px 0; position: relative; }
        .entry-content { color: #ccc; white-space: pre-wrap; line-height: 1.5; font-size: 0.95rem; }
        .photo-gallery { display: flex; gap: 10px; overflow-x: auto; margin-top: 10px; padding-bottom: 5px; }
        .photo-thumb { height: 80px; border-radius: 4px; border: 1px solid #444; cursor: pointer; }

        /* PHOTO UPLOAD */
        .photo-btn { background: #222; border: 1px dashed #555; color: #888; padding: 10px; width: 100%; border-radius: 4px; cursor: pointer; margin-bottom: 10px; text-align: center; }
        .photo-btn:hover { border-color: var(--neon-blue); color: var(--neon-blue); }

        .gratitude-section { border-top: 1px solid #333; padding-top: 20px; margin-top: 20px; }
        .gratitude-title { color: var(--neon-green); font-family: 'Orbitron', sans-serif; margin-bottom: 10px; font-size: 1rem; text-align: center; }
        .gratitude-input { width: 100%; background: #111; border: 1px solid #333; padding: 10px; margin-bottom: 8px; color: #fff; border-radius: 4px; font-family: 'Rajdhani', sans-serif; }
        .gratitude-input:focus { border-color: var(--neon-green); outline: none; }

        .save-btn { background: var(--neon-blue); color: #000; border: none; padding: 10px 20px; font-family: 'Orbitron', sans-serif; font-weight: bold; cursor: pointer; border-radius: 4px; width: 100%; transition: 0.3s; text-align: center; }
        .save-btn:hover { box-shadow: 0 0 15px var(--neon-blue); }
        .save-btn.active { background: var(--neon-green); box-shadow: 0 0 15px var(--neon-green); }
        .save-btn.inactive { background: #333; color: #888; box-shadow: none; }

        .new-entry-card { background: var(--panel-bg); border: 1px solid var(--border-color); border-radius: 8px; padding: 15px; backdrop-filter: blur(5px); }
        .entry-textarea { width: 100%; background: #151520; border: 1px solid #333; color: white; padding: 10px; border-radius: 4px; font-family: 'Rajdhani', sans-serif; font-size: 1rem; min-height: 100px; resize: vertical; margin-bottom: 10px; }

        /* TECH BUTTON */
        .tech-btn { position: relative; width: 100%; height: 4em; outline: none; transition: 0.1s; background-color: transparent; border: none; font-size: 13px; font-weight: bold; color: #ddebf0; cursor: pointer; margin-top: 10px; font-family: 'Orbitron', sans-serif; letter-spacing: 2px; }
        #clip { --color: #2761c3; position: absolute; top: 0; overflow: hidden; width: 100%; height: 100%; border: 5px double var(--color); box-shadow: inset 0px 0px 15px #195480; -webkit-clip-path: polygon(30% 0%, 70% 0%, 100% 30%, 100% 70%, 70% 100%, 30% 100%, 0% 70%, 0% 30%); }
        .arrow { position: absolute; transition: 0.2s; background-color: #2761c3; top: 35%; width: 11%; height: 30%; }
        #leftArrow { left: -13.5%; -webkit-clip-path: polygon(100% 0, 100% 100%, 0 50%); } #rightArrow { -webkit-clip-path: polygon(100% 49%, 0 0, 0 100%); left: 102%; }
        .tech-btn:hover #rightArrow { background-color: #27c39f; left: -15%; animation: 0.6s ease-in-out both infinite alternate rightArrow8; }
        .tech-btn:hover #leftArrow { background-color: #27c39f; left: 103%; animation: 0.6s ease-in-out both infinite alternate leftArrow8; }
        .corner { position: absolute; width: 4em; height: 4em; background-color: #2761c3; box-shadow: inset 1px 1px 8px #2781c3; transform: scale(1) rotate(45deg); transition: 0.2s; }
        #rightTop { top: -1.98em; left: 91%; } #leftTop { top: -1.96em; left: -3.0em; } #leftBottom { top: 2.10em; left: -2.15em; } #rightBottom { top: 45%; left: 88%; }
        .tech-btn:hover .corner { transform: scale(1.25) rotate(45deg); } .tech-btn:hover #clip { animation: 0.2s ease-in-out 0.55s both greenLight8; --color: #27c39f; }
        @keyframes changeColor8 { from { background-color: #2781c3; } to { background-color: #27c39f; } } @keyframes lightEffect8 { from { box-shadow: 1px 1px 5px #27c39f; } to { box-shadow: 0 0 2px #27c39f; } } @keyframes greenLight8 { from { } to { box-shadow: inset 0px 0px 32px #27c39f; } } @keyframes leftArrow8 { from { transform: translate(0px); } to { transform: translateX(10px); } } @keyframes rightArrow8 { from { transform: translate(0px); } to { transform: translateX(-10px); } }

        /* PYRAMID LOADER */
        .pyramid-loader { position: relative; width: 200px; height: 200px; display: block; margin: 0 auto 30px auto; transform-style: preserve-3d; transform: rotateX(-20deg); }
        .wrapper { position: relative; width: 100%; height: 100%; transform-style: preserve-3d; animation: spin 4s linear infinite; }
        @keyframes spin { 100% { transform: rotateY(360deg); } }
        .pyramid-loader .wrapper .side { width: 70px; height: 70px; position: absolute; top: 0; left: 0; right: 0; bottom: 0; margin: auto; transform-origin: center top; clip-path: polygon(50% 0%, 0% 100%, 100% 100%); }
        .pyramid-loader .wrapper .side1 { transform: rotateZ(-30deg) rotateY(90deg); background: conic-gradient( #2BDEAC, #F028FD, #D8CCE6, #2F2585); }
        .pyramid-loader .wrapper .side2 { transform: rotateZ(30deg) rotateY(90deg); background: conic-gradient( #2F2585, #D8CCE6, #F028FD, #2BDEAC); }
        .pyramid-loader .wrapper .side3 { transform: rotateX(30deg); background: conic-gradient( #2F2585, #D8CCE6, #F028FD, #2BDEAC); }
        .pyramid-loader .wrapper .side4 { transform: rotateX(-30deg); background: conic-gradient( #2BDEAC, #F028FD, #D8CCE6, #2F2585); }
        .pyramid-loader .wrapper .shadow { width: 60px; height: 60px; background: #8B5AD5; position: absolute; top: 0; left: 0; right: 0; bottom: 0; margin: auto; transform: rotateX(90deg) translateZ(-40px); filter: blur(12px); }

        .rest-view { text-align: center; padding: 50px 20px; color: #666; }
        .rest-view h2 { color: #fff; margin-bottom: 10px; text-shadow: 0 0 10px var(--neon-purple); }

    </style>
</head>
<body>
    
    <div class="bg-animation"></div>

    <nav class="top-nav">
        <div class="nav-brand">NEXUS <span>V12</span></div>
        <div class="nav-links nav-links-desktop">
            <button class="glitch-btn active" id="nav-tracker" data-text="WORKOUTS" onclick="switchView('tracker')">WORKOUTS</button>
            <button class="glitch-btn" id="nav-journal" data-text="JOURNAL" onclick="switchView('journal')">JOURNAL</button>
        </div>
        <button class="mobile-menu-btn" onclick="toggleMobileMenu()"><i class="fa-solid fa-bars"></i></button>
    </nav>
    <div class="mobile-dropdown" id="mobile-menu">
        <button class="glitch-btn active" onclick="switchView('tracker'); toggleMobileMenu()">WORKOUTS</button>
        <button class="glitch-btn" onclick="switchView('journal'); toggleMobileMenu()">JOURNAL</button>
    </div>

    <div id="view-tracker" class="view-section active-view">
        <div class="scroller-container">
            <div class="week-nav" id="week-scroller"></div>
            <div class="day-nav">
                <button class="day-btn active" onclick="setDay(1)">D1</button>
                <button class="day-btn" onclick="setDay(2)">D2</button>
                <button class="day-btn" onclick="setDay(3)">D3</button>
                <button class="day-btn" onclick="setDay(4)">D4</button>
                <button class="day-btn" onclick="setDay(5)">D5</button>
                <button class="day-btn" onclick="setDay(6)">D6</button>
                <button class="day-btn" onclick="setDay(7)">D7</button>
            </div>
        </div>
        <div id="tracker-content" style="margin-top: 20px;"></div>
    </div>

    <div id="view-journal" class="view-section">
        <div class="journal-container">
            <div class="calendar-wrapper">
                <div class="calendar-header">
                    <button class="week-btn" onclick="changeMonth(-1)"><i class="fa-solid fa-chevron-left"></i></button>
                    <span id="cal-month-year" style="font-size:1.1rem; letter-spacing:1px;"></span>
                    <button class="week-btn" onclick="changeMonth(1)"><i class="fa-solid fa-chevron-right"></i></button>
                </div>
                <div class="calendar-grid" id="calendar-grid"></div>
            </div>

            <div class="selected-date-display" id="selected-date-display">SELECT A DATE</div>

            <div class="new-entry-card">
                <textarea id="journal-input" class="entry-textarea" placeholder="Log entry for selected date..."></textarea>
                
                <button class="photo-btn" onclick="document.getElementById('photo-input').click()">
                    <i class="fa-solid fa-camera"></i> UPLOAD PROGRESS PHOTO
                </button>
                <input type="file" id="photo-input" style="display:none" accept="image/*" onchange="handlePhotoUpload(this)">
                
                <button class="save-btn" onclick="addJournalEntry()">ADD LOG ENTRY</button>
            </div>

            <div class="entry-list" id="journal-list"></div>

            <div class="gratitude-section">
                <div class="gratitude-title">GRATITUDE ARCHIVE</div>
                <input type="text" class="gratitude-input" id="grat-1" placeholder="1. I am grateful for..." oninput="saveGratitude()">
                <input type="text" class="gratitude-input" id="grat-2" placeholder="2. I am grateful for..." oninput="saveGratitude()">
                <input type="text" class="gratitude-input" id="grat-3" placeholder="3. I am grateful for..." oninput="saveGratitude()">
            </div>

            <div style="margin-top:40px; border-top:1px solid #333; padding-top:20px;">
                <h3 style="color:#666; font-size:0.9rem; margin-bottom:10px;">DATA MANAGEMENT</h3>
                <p style="color:#444; font-size:0.7rem;">Note: Photos are stored locally on your device. Clearing browser data will delete them.</p>
                <button class="tech-btn" onclick="exportData()">
                    BACKUP DATA
                    <div id="clip"><div id="leftTop" class="corner"></div><div id="rightBottom" class="corner"></div><div id="rightTop" class="corner"></div><div id="leftBottom" class="corner"></div></div>
                    <span id="rightArrow" class="arrow"></span><span id="leftArrow" class="arrow"></span>
                </button>
                <input type="file" id="import-file" style="display:none" onchange="importData(this)">
                <button class="tech-btn" onclick="document.getElementById('import-file').click()" style="margin-top:15px; color:#aaa;">
                    IMPORT DATA
                    <div id="clip" style="--color: #444;"><div id="leftTop" class="corner"></div><div id="rightBottom" class="corner"></div><div id="rightTop" class="corner"></div><div id="leftBottom" class="corner"></div></div>
                </button>
            </div>
        </div>
    </div>

    <script>
        // --- INDEXED DB SETUP (For Photos) ---
        let db;
        const DB_NAME = 'NexusDB';
        const STORE_NAME = 'photos';

        function initDB() {
            const request = indexedDB.open(DB_NAME, 1);
            request.onupgradeneeded = function(e) {
                db = e.target.result;
                if(!db.objectStoreNames.contains(STORE_NAME)) {
                    db.createObjectStore(STORE_NAME, { keyPath: 'id', autoIncrement: true });
                }
            };
            request.onsuccess = function(e) {
                db = e.target.result;
                console.log("DB Open");
            };
            request.onerror = function(e) { console.error("DB Error", e); };
        }
        initDB();

        // --- APP LOGIC ---
        let currentWeek = 1; let currentDay = 1; let currentView = 'tracker';
        let calDate = new Date();
        let selectedDateKey = new Date().toISOString().split('T')[0];

        const plan = {
            1: { title: "UPPER BODY (POWER)", exercises: [ { name: "Incline Press (DB if available)", isCompound: true, sets: 4, reps: "6-8", rest: "3:00", notes: "Heavy Compound" }, { name: "Weighted Pull-ups / Lat Pulldown", isCompound: true, sets: 3, reps: "6-8", rest: "2:30", notes: "Heavy Compound" }, { name: "Seated DB Overhead Press", isCompound: true, sets: 3, reps: "6-8", rest: "2:30", notes: "Heavy Compound" }, { name: "Chest Supported Row", isCompound: true, sets: 3, reps: "8-10", rest: "90s", notes: "Volume Compound" }, { name: "Barbell Bicep Curl", sets: 3, reps: "8-10", rest: "60s", notes: "Isolation" }, { name: "Overhead Cable Tricep Ext", sets: 3, reps: "8-10", rest: "60s", notes: "Isolation" }, { name: "Neck Ext/Flexion", sets: 3, reps: "15-20", rest: "45s", notes: "Weak Point" } ] },
            2: { title: "LOWER BODY (POWER)", exercises: [ { name: "Hack Squat/Leg Press/BB Squat", isCompound: true, sets: 3, reps: "6-8", rest: "3:00", notes: "Heavy Compound" }, { name: "Romanian Deadlift (RDL)", isCompound: true, sets: 3, reps: "8-10", rest: "2:30", notes: "Heavy Compound" }, { name: "Leg Press (High/Wide)", sets: 3, reps: "8-10", rest: "90s", notes: "Volume Compound" }, { name: "Lying Hamstring Curl", sets: 3, reps: "8-10", rest: "60s", notes: "Isolation" }, { name: "Standing Calf Raise", sets: 4, reps: "8-12", rest: "45s", notes: "Weak Point" }, { name: "Weighted Farmers Walk", sets: 3, reps: "40-60ft", rest: "45s", notes: "Weak Point / Grip" } ] },
            3: { type: "rest", title: "SYSTEM RECHARGE", desc: "Critical Recovery Protocol Active." },
            4: { title: "PUSH (HYPERTROPHY)", exercises: [ { name: "Flat Press (DB if available)", isCompound: true, sets: 3, reps: "10-12", rest: "3:00", notes: "Heavy Compound" }, { name: "Incline Cable Fly", sets: 3, reps: "12-15", rest: "60s", notes: "Isolation" }, { name: "Cable Lateral Raise SS/Cable Front Raise", sets: 4, reps: "12-15", rest: "60s", notes: "Isolation" }, { name: "Pec-Deck Fly", sets: 3, reps: "12-15", rest: "60s", notes: "Isolation" }, { name: "Rope Overhead Tricep Ext", sets: 4, reps: "12-15", rest: "60s", notes: "Isolation" }, { name: "Single-Arm Cable Pushdown", sets: 3, reps: "12-15", rest: "60s", notes: "Isolation" } ] },
            5: { title: "PULL (HYPERTROPHY)", exercises: [ { name: "Wide-Grip Lat Pulldown", isCompound: true, sets: 3, reps: "10-12", rest: "90s", notes: "Volume Compound" }, { name: "Chest-Supported Row", isCompound: true, sets: 3, reps: "10-12", rest: "90s", notes: "Volume Compound" }, { name: "Face Pull", sets: 4, reps: "15-20", rest: "60s", notes: "Isolation" }, { name: "Reverse Pec-Deck Fly", sets: 4, reps: "15-20", rest: "60s", notes: "Isolation" }, { name: "High Cable Bicep Curl", sets: 4, reps: "10-12", rest: "60s", notes: "Isolation" }, { name: "Hammer Curl", sets: 3, reps: "10-12", rest: "60s", notes: "Isolation" }, { name: "Barbell Wrist Curl", sets: 3, reps: "15-20", rest: "45s", notes: "Weak Point" } ] },
            6: { title: "LEGS (HYPERTROPHY)", exercises: [ { name: "Leg Extension (Dropset last set)", sets: 3, reps: "15-20", rest: "60s", notes: "Isolation / Pre-exhaust" }, { name: "Single-Leg Leg Press", isCompound: true, sets: 3, reps: "12-15", rest: "90s", notes: "Volume Compound" }, { name: "Seated Hamstring Curl", sets: 3, reps: "12-15", rest: "60s", notes: "Isolation" }, { name: "Hip Abduction Machine", sets: 3, reps: "15-20", rest: "45s", notes: "Weak Point / Glutes" }, { name: "Seated Calf Raise", sets: 5, reps: "15-20", rest: "45s", notes: "Weak Point" } ] },
            7: { type: "rest", title: "SYSTEM RECHARGE", desc: "Full System Reset & Growth.", isDay7: true }
        };

        window.onload = function() { 
            renderWeeks(); loadState(); renderTracker(); 
            initCalendar(); 
        };

        function toggleMobileMenu() { document.getElementById('mobile-menu').classList.toggle('open'); }
        function switchView(view) {
            currentView = view;
            document.querySelectorAll('.view-section').forEach(el => el.classList.remove('active-view'));
            document.getElementById(`view-${view}`).classList.add('active-view');
            document.querySelectorAll('.glitch-btn').forEach(el => el.classList.remove('active'));
            document.getElementById(`nav-${view}`).classList.add('active');
            if(view === 'journal') setTimeout(renderCalendar, 100);
        }

        // --- TRACKER LOGIC ---
        function renderWeeks() {
            const container = document.getElementById('week-scroller');
            let html = '';
            for(let i=1; i<=8; i++) {
                const isComplete = localStorage.getItem(`nexus_week_complete_${i}`) === 'true';
                const completeClass = isComplete ? 'completed' : '';
                html += `<button class="week-btn ${i === currentWeek ? 'active' : ''} ${completeClass}" onclick="setWeek(${i})">WEEK ${i} <i class="fa-solid fa-check week-completed-icon"></i></button>`;
            }
            container.innerHTML = html;
        }
        function setWeek(w) { currentWeek = w; saveState(); renderWeeks(); renderTracker(); }
        function setDay(d) { currentDay = d; saveState(); document.querySelectorAll('.day-btn').forEach((btn, i) => btn.classList.toggle('active', i+1 === d)); renderTracker(); }

        function renderTracker() {
            const container = document.getElementById('tracker-content');
            const data = plan[currentDay];
            const prefix = `nexus_w${currentWeek}_d${currentDay}`;
            const isCompleted = localStorage.getItem(`${prefix}_completed`) === 'true';
            
            if (data.type === 'rest') {
                let completeBtnHtml = '';
                if(data.isDay7) {
                    const isWeekComplete = localStorage.getItem(`nexus_week_complete_${currentWeek}`) === 'true';
                    const btnText = isWeekComplete ? "WEEK COMPLETE (UNDO)" : "COMPLETE WEEK PROTOCOL";
                    const btnClass = isWeekComplete ? "inactive" : "active";
                    completeBtnHtml = `<button class="save-btn ${btnClass}" onclick="toggleWeekComplete(${currentWeek})" style="margin-top:20px;">${btnText}</button>`;
                }
                container.innerHTML = `<div class="rest-view"><div class="pyramid-loader"><div class="wrapper"><span class="side side1"></span><span class="side side2"></span><span class="side side3"></span><span class="side side4"></span><span class="shadow"></span></div></div><h2>${data.title}</h2><p>${data.desc}</p>${completeBtnHtml}</div>`;
                return;
            }

            let html = '';
            const dateKey = `${prefix}_date`; const timeKey = `${prefix}_time`; const noteKey = `${prefix}_note`;
            const savedDate = localStorage.getItem(dateKey) || ""; const savedTime = localStorage.getItem(timeKey) || ""; const savedNote = localStorage.getItem(noteKey) || "";
            const goalSteps = `${prefix}_goal_steps`; const goalProt = `${prefix}_goal_prot`; const goalWater = `${prefix}_goal_water`;
            const checkSteps = localStorage.getItem(goalSteps) === 'true' ? 'checked' : '';
            const checkProt = localStorage.getItem(goalProt) === 'true' ? 'checked' : '';
            const checkWater = localStorage.getItem(goalWater) === 'true' ? 'checked' : '';

            html += `<div class="goals-card"><div class="goal-item"><i class="fa-solid fa-shoe-prints goal-icon"></i><span class="goal-label">10K STEPS</span><input type="checkbox" class="goal-checkbox" ${checkSteps} onclick="saveData('${goalSteps}', this.checked)"></div><div class="goal-item"><i class="fa-solid fa-drumstick-bite goal-icon"></i><span class="goal-label">200g PROT</span><input type="checkbox" class="goal-checkbox" ${checkProt} onclick="saveData('${goalProt}', this.checked)"></div><div class="goal-item"><i class="fa-solid fa-droplet goal-icon"></i><span class="goal-label">1 GAL H2O</span><input type="checkbox" class="goal-checkbox" ${checkWater} onclick="saveData('${goalWater}', this.checked)"></div></div>`;
            html += `<div class="meta-card"><div class="meta-row"><div class="meta-group"><label>DATE</label><input type="date" class="meta-input" value="${savedDate}" onchange="saveData('${dateKey}', this.value)"></div><div class="meta-group"><label>DURATION</label><input type="text" class="meta-input" placeholder="e.g. 1h 15m" value="${savedTime}" oninput="saveData('${timeKey}', this.value)"></div></div><div class="meta-group"><label>DAILY WORKOUT NOTES</label><textarea class="meta-input" rows="4" placeholder="Energy levels, focus..." oninput="saveData('${noteKey}', this.value)">${savedNote}</textarea></div></div>`;
            html += `<h3 style="margin-bottom:15px; color:var(--neon-blue)">${data.title}</h3>`;

            data.exercises.forEach((ex, index) => {
                let warmupHtml = '';
                if(ex.isCompound) {
                    let inputs = '';
                    for(let w=1; w<=3; w++) {
                        const k = `${prefix}_ex${index}_warm${w}`;
                        const v = localStorage.getItem(k) || "";
                        inputs += `<div class="set-input-group"><label>W${w}</label><input type="text" class="weight-input warmup" placeholder="lbs" value="${v}" inputmode="decimal" oninput="saveData('${k}', this.value)"></div>`;
                    }
                    warmupHtml = `<div class="warmup-section"><div class="warmup-header"><i class="fa-solid fa-fire"></i> WARM UP</div><div class="sets-grid">${inputs}</div></div>`;
                }
                let setsHtml = '';
                for(let s=0; s<ex.sets; s++) {
                    const k = `${prefix}_ex${index}_set${s}`;
                    const v = localStorage.getItem(k) || "";
                    setsHtml += `<div class="set-input-group"><label>SET ${s+1}</label><input type="text" class="weight-input" placeholder="lbs" value="${v}" inputmode="decimal" oninput="saveData('${k}', this.value)"></div>`;
                }
                const userNoteKey = `${prefix}_ex${index}_usernote`;
                const savedUserNote = localStorage.getItem(userNoteKey) || "";
                html += `<div class="ex-card"><div class="ex-header"><div class="ex-title">${ex.name}</div><div class="rest-badge"><i class="fa-regular fa-clock"></i> ${ex.rest}</div></div><div class="ex-details"><div class="detail-item"><i class="fa-solid fa-layer-group"></i> ${ex.sets} Sets</div><div class="detail-item"><i class="fa-solid fa-rotate"></i> ${ex.reps} Reps</div></div>${warmupHtml}<div class="sets-grid" style="margin-top:10px;">${setsHtml}</div><div class="ex-notes-area"><div class="ex-notes-static">${ex.notes}</div><input type="text" class="user-ex-note" placeholder="Your notes (e.g. seat setting)..." value="${savedUserNote}" oninput="saveData('${userNoteKey}', this.value)"></div></div>`;
            });

            const btnText = isCompleted ? "WORKOUT COMPLETE (UNDO)" : "COMPLETE WORKOUT";
            const btnClass = isCompleted ? "inactive" : "active";
            html += `<button class="save-btn ${btnClass}" style="margin-top:20px; width:100%; height:50px; font-size:1.1rem;" onclick="toggleWorkoutComplete()">${btnText}</button>`;
            container.innerHTML = html;
        }

        function toggleWorkoutComplete() {
            const prefix = `nexus_w${currentWeek}_d${currentDay}`;
            const isComplete = localStorage.getItem(`${prefix}_completed`) === 'true';
            localStorage.setItem(`${prefix}_completed`, !isComplete);
            renderTracker();
            document.querySelectorAll('.day-btn').forEach((btn, i) => { if(i+1 === currentDay) btn.classList.toggle('completed', !isComplete); });
        }
        function toggleWeekComplete(weekNum) {
            const isComplete = localStorage.getItem(`nexus_week_complete_${weekNum}`) === 'true';
            localStorage.setItem(`nexus_week_complete_${weekNum}`, !isComplete);
            renderWeeks(); renderTracker();
        }

        // --- CALENDAR & JOURNAL ---
        function initCalendar() { renderCalendar(); selectDate(new Date().toISOString().split('T')[0]); }
        function changeMonth(delta) { calDate.setMonth(calDate.getMonth() + delta); renderCalendar(); }
        function renderCalendar() {
            const year = calDate.getFullYear(); const month = calDate.getMonth();
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const grid = document.getElementById('calendar-grid');
            const monthName = calDate.toLocaleString('default', { month: 'long' });
            document.getElementById('cal-month-year').innerText = `${monthName.toUpperCase()} ${year}`;
            let html = '';
            const days = ['S','M','T','W','T','F','S'];
            days.forEach(d => html += `<div class="cal-day-label">${d}</div>`);
            for(let i=0; i<firstDay; i++) { html += `<div class="cal-day empty"></div>`; }
            for(let d=1; d<=daysInMonth; d++) {
                const dateString = `${year}-${String(month+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
                const hasEntry = checkDataExists(dateString);
                const hasEntryClass = hasEntry ? 'has-entry' : '';
                const selectedClass = dateString === selectedDateKey ? 'selected' : '';
                html += `<div class="cal-day ${hasEntryClass} ${selectedClass}" onclick="selectDate('${dateString}')">${d}</div>`;
            }
            grid.innerHTML = html;
        }
        function checkDataExists(dateStr) {
            const entries = JSON.parse(localStorage.getItem(`nexus_journal_${dateStr}`) || "[]");
            const grat = JSON.parse(localStorage.getItem(`nexus_gratitude_${dateStr}`) || "[]");
            // Also check for photos in IndexedDB? (Async, hard to do in sync render). 
            // Simplified: Checking text entries for now.
            return entries.length > 0 || grat.length > 0;
        }
        function selectDate(dateStr) {
            selectedDateKey = dateStr;
            renderCalendar();
            const dateObj = new Date(dateStr + 'T00:00:00');
            document.getElementById('selected-date-display').innerText = dateObj.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' }).toUpperCase();
            loadJournalEntries(dateStr);
            loadGratitude(dateStr);
        }

        // --- PHOTO HANDLING ---
        function handlePhotoUpload(input) {
            if (input.files && input.files[0]) {
                const file = input.files[0];
                // COMPRESS IMAGE
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = function(event) {
                    const img = new Image();
                    img.src = event.target.result;
                    img.onload = function() {
                        const canvas = document.createElement('canvas');
                        const MAX_WIDTH = 800; 
                        const scaleSize = MAX_WIDTH / img.width;
                        canvas.width = MAX_WIDTH;
                        canvas.height = img.height * scaleSize;
                        const ctx = canvas.getContext('2d');
                        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                        
                        // Convert to compressed Base64
                        const dataUrl = canvas.toDataURL('image/jpeg', 0.7); 
                        savePhotoToDB(selectedDateKey, dataUrl);
                    }
                }
            }
        }

        function savePhotoToDB(date, dataUrl) {
            if(!db) return;
            const transaction = db.transaction([STORE_NAME], 'readwrite');
            const store = transaction.objectStore(STORE_NAME);
            const entry = { date: date, image: dataUrl, timestamp: new Date().getTime() };
            store.add(entry);
            transaction.oncomplete = function() {
                loadJournalEntries(date); // Refresh list to show photo
            };
        }

        // --- JOURNAL ENTRIES ---
        function addJournalEntry() {
            const input = document.getElementById('journal-input'); const text = input.value.trim();
            if (!text) return;
            const entries = JSON.parse(localStorage.getItem(`nexus_journal_${selectedDateKey}`) || "[]");
            const now = new Date();
            const timeStr = now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
            entries.push({ time: timeStr, text: text });
            localStorage.setItem(`nexus_journal_${selectedDateKey}`, JSON.stringify(entries));
            input.value = ""; loadJournalEntries(selectedDateKey); renderCalendar();
        }

        function loadJournalEntries(dateStr) {
            const list = document.getElementById('journal-list');
            list.innerHTML = '';

            // 1. Load Text Entries
            const entries = JSON.parse(localStorage.getItem(`nexus_journal_${dateStr}`) || "[]");
            entries.forEach(entry => { 
                list.innerHTML += `<div class="journal-entry"><div class="entry-date">${entry.time}</div><div class="entry-content">${entry.text}</div></div>`; 
            });

            // 2. Load Photos from IndexedDB
            if(db) {
                const transaction = db.transaction([STORE_NAME], 'readonly');
                const store = transaction.objectStore(STORE_NAME);
                const request = store.getAll();
                request.onsuccess = function(e) {
                    const photos = e.target.result;
                    const daysPhotos = photos.filter(p => p.date === dateStr);
                    if(daysPhotos.length > 0) {
                        let galleryHtml = '<div class="photo-gallery">';
                        daysPhotos.forEach(p => {
                            galleryHtml += `<img src="${p.image}" class="photo-thumb" onclick="alert('Full size view not implemented in V12')">`;
                        });
                        galleryHtml += '</div>';
                        list.innerHTML = galleryHtml + list.innerHTML;
                    }
                };
            }
            
            if (entries.length === 0) list.innerHTML += `<div style="text-align:center; color:#555; padding:20px;">No text entries for this date.</div>`;
        }

        function saveGratitude() {
            const g1 = document.getElementById('grat-1').value;
            const g2 = document.getElementById('grat-2').value;
            const g3 = document.getElementById('grat-3').value;
            localStorage.setItem(`nexus_gratitude_${selectedDateKey}`, JSON.stringify([g1,g2,g3]));
            renderCalendar();
        }
        function loadGratitude(dateStr) {
            const data = JSON.parse(localStorage.getItem(`nexus_gratitude_${dateStr}`) || "[\"\", \"\", \"\"]");
            document.getElementById('grat-1').value = data[0] || "";
            document.getElementById('grat-2').value = data[1] || "";
            document.getElementById('grat-3').value = data[2] || "";
        }

        // --- SYSTEM UTILS ---
        function saveData(key, value) { localStorage.setItem(key, value); }
        function saveState() { localStorage.setItem('nexus_current_week', currentWeek); localStorage.setItem('nexus_current_day', currentDay); }
        function loadState() {
            currentWeek = parseInt(localStorage.getItem('nexus_current_week') || 1);
            currentDay = parseInt(localStorage.getItem('nexus_current_day') || 1);
            document.querySelectorAll('.day-btn').forEach((btn, i) => {
                btn.classList.toggle('active', i+1 === currentDay);
                if(localStorage.getItem(`nexus_w${currentWeek}_d${i+1}_completed`) === 'true') btn.classList.add('completed');
                else btn.classList.remove('completed');
            });
        }

        function exportData() {
            // Note: This only exports LocalStorage (Text). IndexedDB export is complex for a single file.
            const data = JSON.stringify(localStorage);
            const blob = new Blob([data], {type: "application/json"});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a'); a.href = url; a.download = `nexus_backup_${new Date().toISOString().slice(0,10)}.json`; a.click();
            alert("Backup downloaded. Note: Photos are NOT included in this JSON backup file due to size limitations.");
        }

        function importData(input) {
            const file = input.files[0]; if (!file) return;
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    Object.keys(data).forEach(key => { localStorage.setItem(key, data[key]); });
                    alert('SYSTEM RESTORE SUCCESSFUL. REBOOTING...'); location.reload();
                } catch(err) { alert('DATA CORRUPT. RESTORE FAILED.'); }
            };
            reader.readAsText(file);
        }
    </script>
</body>
</html>
