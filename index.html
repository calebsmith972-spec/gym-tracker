<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#000000">
    <title>NEXUS | PURE BODYBUILDING PPL</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;500;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --neon-blue: #00f7ff;
            --neon-purple: #bc13fe;
            --neon-red: #ff9500;
            --neon-green: #0aff0a;
            --neon-yellow: #ffcc00;
            --panel-bg: rgba(10, 10, 15, 0.95);
            --input-bg: rgba(0, 0, 0, 0.8);
            --border-color: #333;
            --text-main: #e0e0e0;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            background-color: #000;
            color: var(--text-main);
            font-family: 'Rajdhani', sans-serif;
            margin: 0;
            padding: 0;
            padding-bottom: 120px;
            overflow-x: hidden;
        }

        /* --- BACKGROUND ANIMATION --- */
        .bg-animation {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; pointer-events: none;
            background: 
                radial-gradient(circle at 15% 50%, rgba(188, 19, 254, 0.05), transparent 25%), 
                radial-gradient(circle at 85% 30%, rgba(0, 247, 255, 0.05), transparent 25%);
            animation: pulseBg 10s ease-in-out infinite alternate;
        }
        .grid-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;
            background-image: 
                linear-gradient(rgba(0, 255, 255, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 255, 255, 0.03) 1px, transparent 1px);
            background-size: 30px 30px;
            pointer-events: none;
        }

        /* --- NAVBAR --- */
        nav.top-nav {
            background: rgba(0,0,0,0.95); border-bottom: 1px solid var(--neon-blue);
            padding: 0 20px; height: 70px;
            position: sticky; top: 0; z-index: 200; backdrop-filter: blur(10px);
            display: flex; justify-content: space-between; align-items: center;
            box-shadow: 0 0 15px rgba(0, 247, 255, 0.2);
        }
        .nav-brand { font-family: 'Orbitron', sans-serif; font-weight: 700; color: #fff; font-size: 1.2rem; letter-spacing: 2px; }
        .nav-brand span { color: var(--neon-red); }
        
        /* --- SCROLLERS --- */
        .scroller-container { position: sticky; top: 70px; z-index: 100; background: rgba(0,0,0,0.9); backdrop-filter: blur(10px); border-bottom: 1px solid #222; }
        .cycle-nav { padding: 10px 15px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #333; }
        .cycle-label { font-family: 'Orbitron', sans-serif; color: var(--neon-purple); font-size: 0.9rem; }
        
        .day-nav { display: flex; overflow-x: auto; gap: 8px; padding: 10px 15px; scrollbar-width: none; background: rgba(10,10,15,0.8); }
        .day-btn { 
            background: #111; border: 1px solid #333; color: #666; 
            min-width: 45px; height: 45px; display: flex; align-items: center; justify-content: center;
            font-family: 'Orbitron', sans-serif; font-size: 0.8rem; border-radius: 4px;
            transition: 0.3s; flex-shrink: 0;
        }
        .day-btn.active { border-color: var(--neon-blue); color: #fff; background: rgba(0, 247, 255, 0.1); box-shadow: 0 0 10px rgba(0, 247, 255, 0.2); }
        .day-btn.completed { border-color: var(--neon-green); color: var(--neon-green); }
        .day-btn.rest { border-color: #555; color: #888; }
        .day-btn.rest.active { border-color: #fff; color: #fff; }

        /* --- CONTENT --- */
        .view-section { display: none; padding: 20px 15px; max-width: 600px; margin: 0 auto; }
        .view-section.active-view { display: block; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- SETTINGS PANEL --- */
        .settings-panel { 
            background: rgba(20, 20, 30, 0.9); border: 1px solid var(--neon-red); 
            border-radius: 8px; padding: 15px; margin-bottom: 25px;
        }
        .settings-header { color: var(--neon-red); font-family: 'Orbitron'; margin-bottom: 10px; font-size: 0.9rem; }
        .settings-label { font-size: 0.8rem; color: #888; display: block; margin-bottom: 5px; font-family: 'Orbitron'; }
        .settings-select {
            width: 100%; background: #000; border: 1px solid #444; color: white;
            padding: 12px; border-radius: 4px; font-family: 'Rajdhani'; font-size: 1rem;
            margin-bottom: 15px;
        }

        /* --- WARMUP SECTION --- */
        .warmup-card {
            background: rgba(255, 204, 0, 0.05); border-left: 3px solid var(--neon-yellow);
            padding: 15px; margin-bottom: 20px; border-radius: 4px;
        }
        .warmup-title { color: var(--neon-yellow); font-family: 'Orbitron'; font-size: 0.9rem; margin-bottom: 10px; display: flex; justify-content: space-between; }
        .warmup-calc-row { display: flex; gap: 10px; align-items: center; margin-bottom: 10px; }
        .warmup-input { width: 80px; background: #000; border: 1px solid var(--neon-yellow); color: #fff; padding: 5px; text-align: center; font-family: 'Orbitron'; }
        .warmup-steps { font-size: 0.85rem; color: #aaa; display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 5px; text-align: center; }
        .warmup-step { background: rgba(0,0,0,0.5); padding: 5px; border-radius: 3px; border: 1px solid #333; }
        .warmup-val { color: var(--neon-yellow); font-weight: bold; display: block; }

        /* --- EXERCISE CARD --- */
        .ex-card { 
            background: var(--panel-bg); border: 1px solid #333; border-radius: 8px; 
            padding: 0; margin-bottom: 20px; position: relative; overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
            transition: 0.3s;
        }
        .ex-card.completed { border-color: var(--neon-green); opacity: 0.7; }
        .ex-card::before {
            content: ''; position: absolute; top: 0; left: 0; width: 4px; height: 100%;
            background: var(--neon-blue);
        }
        .ex-card.weak-point::before { background: var(--neon-red); }

        .ex-header { padding: 15px; border-bottom: 1px solid #222; display: flex; flex-direction: column; gap: 10px; }
        
        .ex-top-row { display: flex; justify-content: space-between; align-items: flex-start; }
        
        .ex-badges { display: flex; flex-wrap: wrap; gap: 5px; margin-top: 5px; }
        .ex-badge { 
            font-size: 0.65rem; font-family: 'Orbitron'; padding: 2px 6px; border-radius: 3px; 
            text-transform: uppercase; letter-spacing: 0.5px;
        }
        .badge-wp { color: var(--neon-red); border: 1px solid var(--neon-red); background: rgba(255, 0, 60, 0.1); }
        .badge-opt { color: var(--neon-green); border: 1px solid var(--neon-green); background: rgba(10, 255, 10, 0.1); }
        .badge-warmup { color: var(--neon-yellow); border: 1px solid var(--neon-yellow); background: rgba(255, 204, 0, 0.1); }
        .badge-intensity { color: var(--neon-purple); border: 1px solid var(--neon-purple); background: rgba(188, 19, 254, 0.1); }

        .ex-name { font-size: 1.2rem; font-weight: 700; color: #fff; margin: 0; line-height: 1.2; text-shadow: 0 0 5px rgba(0,0,0,0.8); }
        .ex-sub-name { font-size: 0.8rem; color: #888; font-style: italic; margin-top: 2px; }
        .ex-sub-name.visible { display: block; color: var(--neon-blue); }

        .ex-actions { display: flex; flex-direction: column; gap: 10px; align-items: flex-end; }
        .swap-btn { background: none; border: 1px solid #444; color: #666; padding: 4px 8px; font-size: 0.7rem; font-family: 'Orbitron'; cursor: pointer; border-radius: 3px; }
        .swap-btn:hover { border-color: var(--neon-blue); color: var(--neon-blue); }
        .swap-btn.active { background: var(--neon-blue); color: #000; }

        .check-btn { 
            width: 30px; height: 30px; border-radius: 50%; background: #222; border: 2px solid #555; 
            color: transparent; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: 0.2s;
        }
        .check-btn.checked { background: var(--neon-green); border-color: var(--neon-green); color: #000; box-shadow: 0 0 10px var(--neon-green); }

        .ex-body { padding: 15px; }
        .ex-stats { display: flex; gap: 15px; margin-bottom: 15px; }
        .stat-box { background: rgba(0,0,0,0.6); padding: 8px; border-radius: 4px; border: 1px solid #333; text-align: center; flex: 1; }
        .stat-label { font-size: 0.7rem; color: #666; font-family: 'Orbitron'; display: block; margin-bottom: 3px; }
        .stat-val { font-size: 1.1rem; color: #fff; font-weight: 700; }

        .ex-notes { 
            background: #111; padding: 10px; border-radius: 4px; font-size: 0.85rem; color: #ccc; 
            border-left: 2px solid #444; margin-bottom: 15px; line-height: 1.4;
        }

        .input-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; }
        .set-input { 
            background: #000; border: 1px solid #444; color: #fff; padding: 10px 5px; 
            text-align: center; border-radius: 4px; font-family: 'Rajdhani'; font-size: 1rem; width: 100%;
        }
        .set-input:focus { border-color: var(--neon-blue); outline: none; box-shadow: 0 0 5px var(--neon-blue); }

        /* --- NAVIGATION BUTTONS --- */
        .nav-action-group { display: flex; gap: 10px; margin-top: 30px; }
        .nav-action-btn {
            flex: 1; background: transparent; border: 1px solid #333; color: #888;
            padding: 15px; font-family: 'Orbitron'; font-size: 0.9rem; letter-spacing: 1px;
            cursor: pointer; transition: 0.3s; position: relative; overflow: hidden;
        }
        .nav-action-btn:hover { background: rgba(255,255,255,0.05); }
        
        .nav-action-btn.prev { border-color: var(--neon-blue); color: var(--neon-blue); }
        .nav-action-btn.prev:hover { background: rgba(0, 247, 255, 0.1); box-shadow: 0 0 15px rgba(0, 247, 255, 0.3); }
        
        .nav-action-btn.next { border-color: var(--neon-red); color: var(--neon-red); }
        .nav-action-btn.next:hover { background: rgba(255, 0, 60, 0.1); box-shadow: 0 0 15px rgba(255, 0, 60, 0.3); }

        .rest-view { text-align: center; padding: 60px 20px; color: #666; }
        .rest-icon { font-size: 4rem; color: #333; margin-bottom: 20px; animation: float 3s ease-in-out infinite; }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }

    </style>
</head>
<body>
    
    <div class="bg-animation"></div>
    <div class="grid-overlay"></div>

    <nav class="top-nav">
        <div class="nav-brand">CAL3B <span>LOG</span></div>
        <div style="color: #666; font-size: 0.8rem; font-family: 'Orbitron';" id="date-display"></div>
    </nav>

    <div class="scroller-container">
        <div class="cycle-nav">
            <span class="cycle-label" id="program-cycle-label">CYCLE 1</span>
            <div style="display:flex; gap:10px;">
                <button onclick="changeView('settings')" style="background:none; border:none; color:#666;"><i class="fa-solid fa-gear"></i></button>
            </div>
        </div>
        <div class="day-nav" id="day-scroller">
            <!-- JS Generated Days -->
        </div>
    </div>

    <!-- WORKOUT VIEW -->
    <div id="view-workout" class="view-section active-view">
        
        <!-- SETTINGS PANEL (Hidden by default) -->
        <div id="settings-area" class="settings-panel" style="display:none;">
            <div class="settings-header">CONFIGURATION PROTOCOL</div>
            
            <label class="settings-label">PROGRAM PHASE</label>
            <select id="phase-selector" class="settings-select" onchange="updatePhase(this.value)">
                <option value="1">PHASE 1 (Weeks 1-5)</option>
                <option value="2">PHASE 2 (Weeks 6-10)</option>
            </select>

            <label class="settings-label">WEAK POINT TARGET</label>
            <select id="weak-point-selector" class="settings-select" onchange="updateWeakPoint(this.value)">
                <option value="chest">CHEST (Press/Fly)</option>
                <option value="back">BACK (Width/Lats)</option>
                <option value="delts">SIDE DELTS</option>
                <option value="quads">QUADS</option>
                <option value="hams">HAMSTRINGS</option>
                <option value="arms">ARMS (Bi/Tri)</option>
                <option value="forearms">FOREARMS</option>
                <option value="neck">NECK</option>
                <option value="glutes">GLUTES</option>
            </select>

            <button onclick="toggleSettings()" style="width:100%; padding:10px; background:#333; color:#fff; border:none; font-family:'Orbitron'; cursor:pointer;">CLOSE CONFIG</button>
            <br><br>
            <button onclick="resetData()" style="width:100%; padding:10px; background:transparent; border:1px solid #555; color:#555; font-family:'Orbitron'; font-size:0.7rem; cursor:pointer;">FACTORY RESET</button>
        </div>

        <div id="tracker-content"></div>
    </div>

    <script>
        // --- DATA STRUCTURES ---
        const WEAK_POINTS = {
            chest: { label: 'Chest', ex1: 'Machine Chest Press', ex2: 'Cable Flye (High-to-Low)' },
            back: { label: 'Back (Width)', ex1: 'Wide Grip Lat Pulldown', ex2: 'Single Arm Cable Row' },
            delts: { label: 'Side Delts', ex1: 'Machine Lateral Raise', ex2: 'DB Upright Row' },
            quads: { label: 'Quads', ex1: 'Leg Extension', ex2: 'Goblet Squat (Heels Elevated)' },
            hams: { label: 'Hamstrings', ex1: 'Seated Leg Curl', ex2: 'Dumbbell RDL' },
            arms: { label: 'Arms', ex1: 'Bayesian Cable Curl', ex2: 'Tricep Pushdown' },
            forearms: { label: 'Forearms', ex1: 'DB Wrist Curl (Flexion)', ex2: 'Reverse Grip EZ-Bar Curl' },
            neck: { label: 'Neck', ex1: 'Plate Neck Curl', ex2: 'Neck Extension' },
            glutes: { label: 'Glutes', ex1: 'Glute Drive', ex2: 'Cable Glute Kickback' }
        };

        const PROGRAM_PHASE_1 = [
            { day: 1, title: "PULL A (P1)", focus: "LAT FOCUSED", exercises: [
                { id: 'p1-1', name: "Cross-Body Lat Pull-Around", sets: 3, reps: "10-12", rest: "2-3m", warmup: "1 Set", intensity: "Long-length Partials", note: "Align wrist and cable. Deep stretch.", sub: "Single Arm Lat Pulldown" },
                { id: 'p1-2', name: "Snatch-Grip RDL", sets: 2, reps: "8-10", rest: "3-4m", warmup: "2-3 Sets", note: "Wide grip. Hamstring focus.", sub: "Dumbbell RDL" },
                { id: 'p1-3', name: "Chest Supported Machine Row", sets: 3, reps: "10-12", rest: "2-3m", warmup: "1-2 Sets", intensity: "Long-length Partials", note: "Chest supported. Drive elbows back.", sub: "Chest-Supported DB Row" },
                { id: 'p1-4', name: "Straight-Bar Lat Prayer", sets: 3, reps: "12-15", rest: "1-2m", warmup: "1 Set", intensity: "Long-length Partials", note: "Keep elbows fixed.", sub: "Cable Pullover (Rope)" },
                { id: 'p1-5', name: "Hammer Preacher Curl", sets: 3, reps: "10-12", rest: "1-2m", warmup: "1 Set", note: "Close grip. Full ROM.", sub: "DB Preacher Curl" },
                { id: 'p1-6', name: "Lying Paused Rope Face Pull", sets: 3, reps: "10-12", rest: "90s", warmup: "1 Set", note: "Pause 1s at contraction.", sub: "Reverse Pec Deck" }
            ]},
            { day: 2, title: "PUSH A (P1)", focus: "CHEST & DELTS", exercises: [
                { id: 'pu1-1', name: "Cuffed Behind-Back Lateral Raise", sets: 3, reps: "10-12", rest: "1-2m", warmup: "1-2 Sets", intensity: "Myo-reps", note: "Myo-reps on last set.", sub: "Cable Lateral Raise" },
                { id: 'pu1-2', name: "Low Incline Smith Press", sets: 3, reps: "8-10", rest: "3m", warmup: "2-3 Sets", intensity: "Pec Static Stretch (30s)", note: "15-30 deg incline. Control negative.", sub: "Low Incline DB Press" },
                { id: 'pu1-3', name: "Pec Deck (Integrated Partials)", sets: 3, reps: "10-12", rest: "1-2m", warmup: "1 Set", intensity: "Integrated Partials", note: "Full reps then partials on last set.", sub: "Cable Flye" },
                { id: 'pu1-4', name: "Overhead Cable Tri Ext", sets: 3, reps: "8", rest: "1-2m", warmup: "1 Set", intensity: "Dropset", note: "Elbows high.", sub: "DB Overhead Ext" },
                { id: 'pu1-5', name: "Triceps Pressdown", sets: 2, reps: "8-10", rest: "90s", warmup: "1 Set", intensity: "Dropset", note: "Lock out hard.", sub: "Band Pushdown" },
                { id: 'pu1-6', name: "Cable Crunch", sets: 3, reps: "10-15", rest: "90s", warmup: "1 Set", intensity: "Myo-reps", note: "Round back, don't use hips.", sub: "Weighted Sit-Up" }
            ]},
            { day: 3, title: "LEGS A (P1)", focus: "QUADS & HAMS", exercises: [
                { id: 'l1-1', name: "Seated Leg Curl", sets: 3, reps: "8-10", rest: "2-3m", warmup: "1-2 Sets", intensity: "Long-length Partials", note: "Control eccentric.", sub: "Lying Leg Curl" },
                { id: 'l1-2', name: "Smith Machine Squat", sets: 3, reps: "4,6,8", rest: "3-4m", warmup: "2-4 Sets", note: "Heavy compound.", sub: "Hack Squat / Front Squat" },
                { id: 'l1-3', name: "Machine Hip Adduction", sets: 3, reps: "10-12", rest: "90s", warmup: "1 Set", note: "Full ROM.", sub: "Cable Adduction" },
                { id: 'l1-4', name: "Leg Extension", sets: 3, reps: "10-12", rest: "1-2m", warmup: "1-2 Sets", intensity: "Long-length Partials", note: "Squeeze top.", sub: "Sissy Squat" },
                { id: 'l1-5', name: "Calf Press on Leg Press", sets: 3, reps: "10-12", rest: "90s", warmup: "1 Set", intensity: "Calf Static Stretch (30s)", note: "Pause in stretch.", sub: "Seated Calf Raise" }
            ]},
            { day: 4, title: "ARMS + WEAK POINT", focus: "SPECIFICITY", isWeakPoint: true, exercises: [
                { id: 'aw1-1', isWPSlot: 1, sets: 3, reps: "8-12", rest: "2-3m", warmup: "1-3 Sets", note: "Weak point focus exercise." },
                { id: 'aw1-2', isWPSlot: 2, sets: 2, reps: "10-15", rest: "2m", warmup: "1 Set", optional: true, note: "Optional secondary weak point volume." },
                { id: 'aw1-3', name: "Bayesian Cable Curl", sets: 3, reps: "8-10", rest: "1-2m", warmup: "1 Set", note: "Long-length Partials", sub: "DB Curl" },
                { id: 'aw1-4', name: "Seated DB French Press", sets: 3, reps: "10", rest: "1-2m", warmup: "1 Set", note: "To hairline.", sub: "DB Skull Crusher" },
                { id: 'aw1-5', name: "Bottom-2/3 Constant Tension Preacher Curl", sets: 2, reps: "10-12", rest: "2m", warmup: "1 Set", note: "Elbows high.", sub: "Spider Curl" },
                { id: 'aw1-6', name: "Cable Tricep Kickback", sets: 2, reps: "12-15", rest: "90s", warmup: "0 Sets", note: "Pin elbow back.", sub: "DB Kickback" },
                { id: 'aw1-7', name: "Roman Chair Leg Raise", sets: 3, reps: "10-20", rest: "90s", warmup: "0 Sets", note: "Pin elbow back.", sub: "DB Kickback" }
            ]},
            { day: 5, title: "REST / RECOVERY", isRest: true },
            { day: 6, title: "PULL B (P1)", focus: "MID-BACK", exercises: [
                { id: 'p2-1', name: "Super-ROM Cable Row", sets: 3, reps: "10-12", rest: "1-2m", warmup: "1-2 Sets", note: "Round upper back in stretch.", sub: "T-Bar Row" },
                { id: 'p2-2', name: "45-Deg Hyperextension", sets: 2, reps: "12-15", rest: "2m", warmup: "1 Set", note: "Lower back/glutes.", sub: "Rack Pull" },
                { id: 'p2-3', name: "Lean-Back Lat Pulldown", sets: 3, reps: "10-12", rest: "2m", warmup: "1-2 Sets", intensity: "Dropset", note: "Lean back for lower lats.", sub: "Neutral Grip Pulldown" },
                { id: 'p2-4', name: "Inverse DB Zottman Curl", sets: 3, reps: "10-12", rest: "2m", warmup: "1 Set", note: "Up reverse, down normal.", sub: "Hammer Curl" },
                { id: 'p2-5', name: "Cable Reverse Fly (Mechanical Dropset)", sets: 3, reps: "5,4,3", rest: "90s", warmup: "0 Sets", intensity: "Mechanical Dropset", note: "You'll probably want to watch the video for this one. Take ~3 big steps back from the cable machine and do your first 5 reps. After those first 5 reps, immediately (without resting) take 1 step forward and do another 4 reps. Then (without resting) take another step forward and do at least another 3 reps (or until you hit RPE 9-10).", sub: "DB Reverse Flye" },
                { id: 'p2-6', name: "Cable Paused Shrug-In", sets: 3, reps: "10-12", rest: "90s", warmup: "1 Set", note: "Shrug up and in.", sub: "DB Shrug" }
            ]},
            { day: 7, title: "PUSH B (P1)", focus: "DELTS & UPPER", exercises: [
                { id: 'pu2-1', name: "Machine Shoulder Press", sets: 3, reps: "10-12", rest: "1-2m", warmup: "2-3 Sets", intensity: "Dropset", note: "Heavy compound.", sub: "DB Shoulder Press" },
                { id: 'pu2-2', name: "Cross-Body Cable Y-Raise", sets: 3, reps: "10-12", rest: "2m", warmup: "1 Set", note: "Side delts in lengthened pos.", sub: "DB Y-Raise (Incline)" },
                { id: 'pu2-3', name: "Paused Assisted Dip", sets: 3, reps: "8-10", rest: "2m", warmup: "2 Sets", note: "Slow 2-3 second negative. 1-2 second pause at the bottom. Explode with control on the way up. Go as deep as your shoulders comfortably allow, trying to at least break a 90° elbow angle.", sub: "Machine Dip" },
                { id: 'pu2-4', name: "DB Low Incline Flye", sets: 2, reps: "15-20", rest: "90s", warmup: "1 Set", intensity: "Long-length Partials", note: "Deep stretch.", sub: "Pec Deck" },
                { id: 'pu2-5', name: "Katana Triceps Ext", sets: 3, reps: "10-12", rest: "2m", warmup: "1 Set", note: "Flare your elbows out at about 45° and keep your elbows locked in place as you complete the extensions.", sub: "Rope Overhead Ext" },
                { id: 'pu2-6', name: "Ab Wheel Rollout", sets: 3, reps: "10-20", rest: "2m", warmup: "0 Sets", note: "Tight core.", sub: "Hanging Leg Raise" }
            ]},
            { day: 8, title: "LEGS B (P1)", focus: "HAMS & QUADS", exercises: [
                { id: 'l2-1', name: "Lying Leg Curl", sets: 3, reps: "8-10", rest: "1-2m", warmup: "1-2 Sets", intensity: "Long-length Partials", note: "Hips into pad.", sub: "Seated Leg Curl" },
                { id: 'l2-2', name: "Leg Press", sets: 3, reps: "8", rest: "1-2m", warmup: "2-4 Sets", note: "Feet lower on the platform for more quad focus. Get as deep as you can without excessive back rounding. Control the negative and do a slight pause at the bottom of each rep. Try to add a little weight each week at the same rep count.", sub: "High Bar Squat" },
                { id: 'l2-3', name: "Smith Machine Lunge", sets: 2, reps: "8", rest: "3-4m", warmup: "2-3 Sets", note: "Reverse lunge.", sub: "DB Walking Lunge" },
                { id: 'l2-4', name: "Machine Hip Adduction", sets: 3, reps: "10-12", rest: "45s", warmup: "1 Set", note: "Squeeze.", sub: "Cable Adduction" },
                { id: 'l2-5', name: "Sissy Squat", sets: 3, reps: "10-12", rest: "45s", warmup: "1 Set", note: "Lean back.", sub: "Leg Extension" },
                { id: 'l2-6', name: "Standing Calf Raise", sets: 3, reps: "10-12", rest: "90s", warmup: "1 Set", intensity: "Calf Static Stretch (30s)", note: "1-2 second pause at the bottom of each rep. Instead of just going up onto your toes, think about rolling your ankle back and forth on the balls of your feet.", sub: "Donkey Calf Raise" }
            ]},
            { day: 9, title: "ARMS + WEAK POINT", focus: "SPECIFICITY", isWeakPoint: true, exercises: [
                { id: 'aw2-1', isWPSlot: 1, sets: 3, reps: "8-12", rest: "2-3m", warmup: "1-3 Sets", note: "Weak point focus.", optional: false },
                { id: 'aw2-2', isWPSlot: 2, sets: 2, reps: "10-15", rest: "2m", warmup: "1 Set", optional: true, note: "Secondary weak point." },
                { id: 'aw2-3', name: "Cable Skull Crusher", sets: 3, reps: "10-12", rest: "1-2m", warmup: "1 Set", note: "Allow the cable to move back behind your head for maximum stretch on the triceps. Reach full extension with your elbows still around eye level at the top", sub: "Seated DB Press" },
                { id: 'aw2-4', name: "Kneeling Cable Overhead Tri Ext", sets: 3, reps: "10-12", rest: "1-2m", warmup: "1 Set", note: "Rope. Flare elbows.", sub: "EZ Bar French Press" },
                { id: 'aw2-5', name: "Triceps Diverging Pressdown (Long Rope or 2 Ropes)", sets: 2, reps: "12-15", rest: "1-2m", warmup: "1 Set", note: "Use two long ropes or one long rope. Lean slightly forward, flare your elbows slightly out and keep your arms back in line with your torso. Then do triceps pressdowns, getting a full, big squeeze at the bottom.", sub: "Incline DB Curl" },
                { id: 'aw2-6', name: "Incline DB Stretch Curl", sets: 2, reps: "12-15", rest: "90s", warmup: "1 Set", note: "Keep your upper back planted against the bench, rotate your arms outward until you feel a massive stretch in your biceps. Go light on these and instead focus on feeling your biceps pull and squeeze.", sub: "Rope Cable Hammer" },
                { id: 'aw2-7', name: "Cable Crunch", sets: 3, reps: "10-12", rest: "90s", warmup: "1 Set" }
            ]},
            { day: 10, title: "REST / RECOVERY", isRest: true }
        ];

        const PROGRAM_PHASE_2 = [
            { day: 1, title: "PULL A (P2)", focus: "LAT & DETAILS", exercises: [
                { id: 'p2a-1', name: "Lat-Focused Cable Row", sets: 3, reps: "10-12", rest: "2m", warmup: "1 Set", intensity: "Integrated Partials", note: "Focus on driving elbow down. Partials at end.", sub: "Single Arm Pull-around" },
                { id: 'p2a-2', name: "Cable 1-Arm Face Pull", sets: 3, reps: "12-15", rest: "90s", warmup: "1 Set", note: "External rotation focus.", sub: "Rope Face Pull" },
                { id: 'p2a-3', name: "Chest-Supported Machine Row", sets: 3, reps: "10-12", rest: "2m", warmup: "2 Sets", intensity: "Long-length Partials", note: "Drive elbows back.", sub: "DB Row" },
                { id: 'p2a-4', name: "Seated Super-Bayesian Cable Curl", sets: 3, reps: "10-12", rest: "90s", warmup: "1 Set", note: "Arms behind body, cable set high.", sub: "Incline DB Curl" },
                { id: 'p2a-5', name: "Cable Crunch", sets: 3, reps: "10-15", rest: "90s", warmup: "1 Set", note: "Kneeling or standing.", sub: "Weighted Sit-up" },
                { id: 'p2a-6', name: "Meadows Incline DB Lateral Raise", sets: 3, reps: "12-15", rest: "90s", warmup: "0 Sets", note: "Lay sideways on incline bench. Raise DB.", sub: "Cable Lateral Raise" }
            ]},
            { day: 2, title: "PUSH A (P2)", focus: "CHEST & DELTS", exercises: [
                { id: 'p2b-1', name: "Flat Machine Chest Press", sets: 3, reps: "8-10", rest: "3m", warmup: "2-3 Sets", intensity: "Lengthened Partials", note: "Heavy compound.", sub: "DB Bench Press" },
                { id: 'p2b-2', name: "Bottom-Half Seated Cable Flye", sets: 3, reps: "10-12", rest: "2m", warmup: "1 Set", intensity: "Extend Set", note: "Focus purely on the stretch portion.", sub: "Pec Deck" },
                { id: 'p2b-3', name: "DB Shoulder Press", sets: 3, reps: "8-12", rest: "3m", warmup: "2 Sets", note: "Seated or standing.", sub: "Machine Shoulder Press" },
                { id: 'p2b-4', name: "Overhead Cable Tri Ext", sets: 3, reps: "10-12", rest: "2m", warmup: "1 Set", intensity: "Dropset", note: "Rope/Bar. Elbows high.", sub: "Skull Crusher" },
                { id: 'p2b-5', name: "Cable Triceps Kickback", sets: 3, reps: "12-15", rest: "90s", warmup: "0 Sets", note: "Strict form.", sub: "DB Kickback" }
            ]},
            { day: 3, title: "LEGS A (P2)", focus: "QUADS & HAMS", exercises: [
                { id: 'p2c-1', name: "Seated Leg Curl", sets: 3, reps: "10-12", rest: "2m", warmup: "1-2 Sets", intensity: "Lengthened Partials", note: "Hamstring focus.", sub: "Lying Leg Curl" },
                { id: 'p2c-2', name: "Bottom-Half Smith Machine Squat", sets: 3, reps: "6-8", rest: "3m", warmup: "2-4 Sets", intensity: "Extend Set", note: "Do bottom half reps only, then full reps.", sub: "Pause Squat" },
                { id: 'p2c-3', name: "Glute-Ham Raise", sets: 3, reps: "10-12", rest: "2m", warmup: "1 Set", note: "Or Nordic Curls.", sub: "RDL" },
                { id: 'p2c-4', name: "Leg Extension", sets: 3, reps: "12-15", rest: "90s", warmup: "1 Set", intensity: "Long-length Partials", note: "Burnout.", sub: "Sissy Squat" },
                { id: 'p2c-5', name: "Standing Calf Raise", sets: 4, reps: "10-15", rest: "90s", warmup: "1 Set", intensity: "Weighted Static Hold", note: "Hold stretch for 30s.", sub: "Leg Press Calf Raise" },
                { id: 'p2c-6', name: "Machine Hip Abduction", sets: 3, reps: "15-20", rest: "90s", warmup: "1 Set", note: "Outer glute.", sub: "Cable Abduction" }
            ]},
            { day: 4, title: "ARMS + WEAK POINT (P2)", focus: "SPECIFICITY", isWeakPoint: true, exercises: [
                { id: 'p2d-1', isWPSlot: 1, sets: 3, reps: "8-12", rest: "2-3m", warmup: "1-3 Sets", note: "Weak point focus exercise." },
                { id: 'p2d-2', isWPSlot: 2, sets: 2, reps: "10-15", rest: "2m", warmup: "1 Set", optional: true, note: "Secondary weak point exercise." },
                { id: 'p2d-3', name: "EZ-Bar Cable Curl", sets: 3, reps: "10-12", rest: "2m", warmup: "1 Set", note: "Cable stack.", sub: "Barbell Curl" },
                { id: 'p2d-4', name: "EZ-Bar Skull Crusher", sets: 3, reps: "10-12", rest: "2m", warmup: "1 Set", note: "To hairline.", sub: "DB Skull Crusher" },
                { id: 'p2d-5', name: "Bottom-Half Incline DB Curl", sets: 3, reps: "10-12", rest: "2m", warmup: "1 Set", note: "Emphasis on stretch.", sub: "Bayesian Curl" },
                { id: 'p2d-6', name: "Triceps Pressdown", sets: 3, reps: "10-12", rest: "90s", warmup: "1 Set", note: "Straight bar.", sub: "Rope Pushdown" }
            ]},
            { day: 5, title: "REST / RECOVERY", isRest: true },
            { day: 6, title: "PULL B (P2)", focus: "MID-BACK", exercises: [
                { id: 'p2e-1', name: "Smith Machine Deficit Row", sets: 3, reps: "8-10", rest: "3m", warmup: "2-3 Sets", intensity: "Lengthened Partials", note: "Stand on block/plate for deficit.", sub: "Pendlay Row" },
                { id: 'p2e-2', name: "Neutral-Grip Lat Pulldown", sets: 3, reps: "10-12", rest: "2m", warmup: "1-2 Sets", intensity: "Integrated Partials", note: "Elbows in.", sub: "Chin Up" },
                { id: 'p2e-3', name: "Moto Cable Row", sets: 3, reps: "12-15", rest: "2m", warmup: "1 Set", note: "Single arm, twisting motion.", sub: "DB Row" },
                { id: 'p2e-4', name: "Bottom-Half EZ-Bar Preacher Curl", sets: 3, reps: "10-12", rest: "2m", warmup: "1 Set", note: "Stretch focus.", sub: "Machine Preacher Curl" },
                { id: 'p2e-5', name: "Super-Stretch Reverse Pec Deck", sets: 3, reps: "12-15", rest: "90s", warmup: "1 Set", note: "Rear delts.", sub: "Face Pull" },
                { id: 'p2e-6', name: "Machine Cheat Shrug", sets: 3, reps: "10-12", rest: "90s", warmup: "1 Set", note: "Controlled cheat on concentric.", sub: "DB Shrug" }
            ]},
            { day: 7, title: "PUSH B (P2)", focus: "DELTS & UPPER", exercises: [
                { id: 'p2f-1', name: "High-Cable Cuffed Lateral Raise", sets: 3, reps: "12-15", rest: "2m", warmup: "1 Set", intensity: "Lengthened Partials", note: "Cable set high.", sub: "DB Lateral Raise" },
                { id: 'p2f-2', name: "Bottom-Half Low Incline DB Press", sets: 3, reps: "10-12", rest: "3m", warmup: "2 Sets", note: "Stretch focus.", sub: "Incline Smith Press" },
                { id: 'p2f-3', name: "Machine Shoulder Press", sets: 3, reps: "10-12", rest: "2m", warmup: "1 Set", note: "Constant tension.", sub: "DB Press" },
                { id: 'p2f-4', name: "Katana Triceps Ext", sets: 3, reps: "10-12", rest: "2m", warmup: "1 Set", intensity: "Lengthened Partials", note: "Dual cable overhead.", sub: "Overhead DB Ext" },
                { id: 'p2f-5', name: "Cable Crossover Ladder", sets: 3, reps: "AMRAP", rest: "2m", warmup: "1 Set", note: "High to low, then mid, then low.", sub: "Cable Flye" }
            ]},
            { day: 8, title: "LEGS B (P2)", focus: "HAMS & QUADS", exercises: [
                { id: 'p2g-1', name: "Barbell RDL", sets: 3, reps: "8-10", rest: "3m", warmup: "2-3 Sets", note: "Heavy hinge.", sub: "DB RDL" },
                { id: 'p2g-2', name: "Super-ROM Leg Press", sets: 3, reps: "10-12", rest: "3m", warmup: "2-4 Sets", note: "Deepest possible depth.", sub: "Hack Squat" },
                { id: 'p2g-3', name: "Smith Machine Reverse Lunge", sets: 3, reps: "10-12", rest: "2m", warmup: "2 Sets", note: "Unilateral focus.", sub: "Walking Lunge" },
                { id: 'p2g-4', name: "Weighted 45-Deg Hyperextension", sets: 3, reps: "12-15", rest: "2m", warmup: "1 Set", note: "Glute/Ham focus.", sub: "Good Morning" },
                { id: 'p2g-5', name: "Leg Extension", sets: 3, reps: "15-20", rest: "90s", warmup: "1 Set", intensity: "Slow Eccentric", note: "3-4s down.", sub: "Sissy Squat" },
                { id: 'p2g-6', name: "Seated Calf Raise", sets: 3, reps: "12-15", rest: "90s", warmup: "1 Set", note: "Soleus focus.", sub: "Standing Calf Raise" }
            ]},
            { day: 9, title: "ARMS + WEAK POINT (P2)", focus: "SPECIFICITY", isWeakPoint: true, exercises: [
                { id: 'p2h-1', isWPSlot: 1, sets: 3, reps: "8-12", rest: "2-3m", warmup: "1-3 Sets", note: "Weak point focus.", optional: false },
                { id: 'p2h-2', isWPSlot: 2, sets: 2, reps: "10-15", rest: "2m", warmup: "1 Set", optional: true, note: "Secondary weak point." },
                { id: 'p2h-3', name: "Kneeling Overhead Cable Curl", sets: 3, reps: "10-12", rest: "2m", warmup: "1 Set", note: "Bicep peak.", sub: "Spider Curl" },
                { id: 'p2h-4', name: "Triceps Diverging Pressdown", sets: 3, reps: "10-12", rest: "2m", warmup: "1 Set", note: "Or dual rope.", sub: "Straight Bar Pushdown" },
                { id: 'p2h-5', name: "Incline DB Stretch-Curl", sets: 3, reps: "12-15", rest: "90s", warmup: "0 Sets", note: "Deep stretch.", sub: "Bayesian Curl" },
                { id: 'p2h-6', name: "Machine Crunch", sets: 3, reps: "15-20", rest: "90s", warmup: "0 Sets", note: "Abs.", sub: "Cable Crunch" }
            ]},
            { day: 10, title: "REST / RECOVERY", isRest: true }
        ];

        // --- APP STATE ---
        let state = {
            dayIndex: 0,
            cycle: 1,
            phase: 1,
            weakPoint: 'chest',
            substitutions: {},
            completed: {},
            history: {}
        };

        // --- INIT ---
        window.onload = function() {
            loadState();
            document.getElementById('date-display').innerText = new Date().toLocaleDateString();
            document.getElementById('weak-point-selector').value = state.weakPoint;
            document.getElementById('phase-selector').value = state.phase;
            renderNav();
            renderWorkout();
        };

        function loadState() {
            const saved = localStorage.getItem('nexus_ppl_v2');
            if(saved) state = JSON.parse(saved);
        }

        function saveState() {
            localStorage.setItem('nexus_ppl_v2', JSON.stringify(state));
        }

        function toggleSettings() {
            const el = document.getElementById('settings-area');
            el.style.display = el.style.display === 'none' ? 'block' : 'none';
        }

        function updateWeakPoint(val) {
            state.weakPoint = val;
            saveState();
            renderWorkout();
        }

        function updatePhase(val) {
            state.phase = parseInt(val);
            saveState();
            renderNav();
            renderWorkout();
        }

        function resetData() {
            if(confirm("FACTORY RESET: All progress will be lost. Proceed?")) {
                localStorage.removeItem('nexus_ppl_v2');
                location.reload();
            }
        }

        // --- RENDERERS ---
        function renderNav() {
            const container = document.getElementById('day-scroller');
            container.innerHTML = '';
            
            const currentProgram = state.phase === 1 ? PROGRAM_PHASE_1 : PROGRAM_PHASE_2;
            
            currentProgram.forEach((day, index) => {
                const btn = document.createElement('button');
                btn.className = `day-btn ${index === state.dayIndex ? 'active' : ''} ${day.isRest ? 'rest' : ''}`;
                btn.innerText = `D${day.day}`;
                btn.onclick = () => {
                    state.dayIndex = index;
                    saveState();
                    renderNav();
                    renderWorkout();
                };
                container.appendChild(btn);
            });
            document.getElementById('program-cycle-label').innerText = `CYCLE ${state.cycle}`;
        }

        function renderWorkout() {
            const container = document.getElementById('tracker-content');
            const currentProgram = state.phase === 1 ? PROGRAM_PHASE_1 : PROGRAM_PHASE_2;
            const dayData = currentProgram[state.dayIndex];
            container.innerHTML = '';

            // 1. Header
            container.innerHTML += `
                <div style="margin-bottom:20px; border-left:4px solid var(--neon-blue); padding-left:15px;">
                    <h1 style="margin:0; font-size:1.8rem; color:#fff; text-shadow:0 0 10px var(--neon-blue);">${dayData.title}</h1>
                    <span style="color:var(--neon-purple); font-family:'Orbitron'; font-size:0.8rem; letter-spacing:2px;">${dayData.focus}</span>
                </div>
            `;

            if(dayData.isRest) {
                container.innerHTML += `
                    <div class="rest-view">
                        <i class="fa-solid fa-battery-full rest-icon"></i>
                        <h2>SYSTEM RECHARGE</h2>
                        <p>Growth happens during recovery.</p>
                        <button class="complete-day-btn" onclick="completeDay()">COMPLETE RECOVERY</button>
                    </div>
                `;
                return;
            }

            // 2. Warmup Calculator
            container.innerHTML += `
                <div class="warmup-card">
                    <div class="warmup-title">
                        <span><i class="fa-solid fa-fire"></i> WARM-UP PROTOCOL</span>
                    </div>
                    <div class="warmup-calc-row">
                        <span style="font-size:0.8rem; color:#888;">TARGET WEIGHT:</span>
                        <input type="number" id="warmup-base" class="warmup-input" placeholder="lbs/kg" oninput="calcWarmup(this.value)">
                    </div>
                    <div class="warmup-steps" id="warmup-steps-display">
                        <div class="warmup-step"><span class="warmup-val">--</span>10 Reps (50%)</div>
                        <div class="warmup-step"><span class="warmup-val">--</span>4 Reps (70%)</div>
                        <div class="warmup-step"><span class="warmup-val">--</span>1 Rep (90%)</div>
                    </div>
                </div>
            `;

            // 3. Exercises
            dayData.exercises.forEach((ex, idx) => {
                let name = ex.name;
                let note = ex.note;
                let subName = ex.sub;
                let isWeakPoint = false;

                // Handle Weak Point Slots
                if(ex.isWPSlot) {
                    const wp = WEAK_POINTS[state.weakPoint];
                    if(ex.isWPSlot === 1) { name = wp.ex1; note = `Heavy Compound focus for ${wp.label}`; subName = "Alternate Machine Var"; }
                    if(ex.isWPSlot === 2) { name = wp.ex2; note = `Isolation / Pump focus for ${wp.label}`; subName = "Alternate Cable Var"; }
                    isWeakPoint = true;
                }

                const isSubbed = state.substitutions[ex.id];
                const displayName = isSubbed ? subName : name;
                const displaySub = isSubbed ? name : subName;
                const isDone = state.completed[`${state.cycle}-${ex.id}`];

                let badgesHtml = '';
                if(isWeakPoint) badgesHtml += `<span class="ex-badge badge-wp">WEAK POINT</span>`;
                if(ex.optional) badgesHtml += `<span class="ex-badge badge-opt">OPTIONAL</span>`;
                if(ex.warmup) badgesHtml += `<span class="ex-badge badge-warmup">WARM-UP: ${ex.warmup}</span>`;
                if(ex.intensity) badgesHtml += `<span class="ex-badge badge-intensity">${ex.intensity}</span>`;

                const html = `
                    <div class="ex-card ${isDone ? 'completed' : ''} ${isWeakPoint ? 'weak-point' : ''}">
                        <div class="ex-header">
                            <div class="ex-top-row">
                                <div>
                                    <h3 class="ex-name">${displayName}</h3>
                                    <span class="ex-sub-name ${isSubbed ? 'visible' : ''}">Substituted from original</span>
                                </div>
                                <div class="ex-actions">
                                    <button class="check-btn ${isDone ? 'checked' : ''}" onclick="toggleComplete('${ex.id}')">
                                        <i class="fa-solid fa-check"></i>
                                    </button>
                                    ${!isWeakPoint ? `<button class="swap-btn ${isSubbed ? 'active' : ''}" onclick="toggleSub('${ex.id}')">SWAP</button>` : ''}
                                </div>
                            </div>
                            <div class="ex-badges">
                                ${badgesHtml}
                            </div>
                        </div>
                        <div class="ex-body">
                            <div class="ex-stats">
                                <div class="stat-box">
                                    <span class="stat-label">SETS</span>
                                    <span class="stat-val">${ex.sets}</span>
                                </div>
                                <div class="stat-box">
                                    <span class="stat-label">REPS</span>
                                    <span class="stat-val">${ex.reps}</span>
                                </div>
                                <div class="stat-box">
                                    <span class="stat-label">REST</span>
                                    <span class="stat-val">${ex.rest}</span>
                                </div>
                            </div>
                            <div class="ex-notes">
                                <i class="fa-solid fa-circle-info"></i> "${note}"
                            </div>
                            <div class="input-grid">
                                ${Array(ex.sets).fill(0).map((_, i) => 
                                    `<input type="text" class="set-input" placeholder="Set ${i+1}">`
                                ).join('')}
                            </div>
                        </div>
                    </div>
                `;
                container.innerHTML += html;
            });

            container.innerHTML += `
                <div class="nav-action-group">
                    <button class="nav-action-btn prev" onclick="prevDay()">
                        <i class="fa-solid fa-backward"></i> REVERT
                    </button>
                    <button class="nav-action-btn next" onclick="completeDay()">
                        ADVANCE <i class="fa-solid fa-forward"></i>
                    </button>
                </div>
            `;
        }

        // --- ACTIONS ---
        function calcWarmup(weight) {
            const w = parseFloat(weight);
            if(!w) {
                document.getElementById('warmup-steps-display').innerHTML = `
                    <div class="warmup-step"><span class="warmup-val">--</span>10 Reps (50%)</div>
                    <div class="warmup-step"><span class="warmup-val">--</span>4 Reps (70%)</div>
                    <div class="warmup-step"><span class="warmup-val">--</span>1 Rep (90%)</div>
                `;
                return;
            }
            const s1 = Math.round(w * 0.5);
            const s2 = Math.round(w * 0.7);
            const s3 = Math.round(w * 0.9);
            document.getElementById('warmup-steps-display').innerHTML = `
                <div class="warmup-step"><span class="warmup-val">${s1}</span>10 Reps</div>
                <div class="warmup-step"><span class="warmup-val">${s2}</span>4 Reps</div>
                <div class="warmup-step"><span class="warmup-val">${s3}</span>1 Rep</div>
            `;
        }

        function toggleSub(exId) {
            state.substitutions[exId] = !state.substitutions[exId];
            saveState();
            renderWorkout();
        }

        function toggleComplete(exId) {
            const key = `${state.cycle}-${exId}`;
            state.completed[key] = !state.completed[key];
            saveState();
            renderWorkout();
        }

        function completeDay() {
            window.scrollTo(0,0);
            state.dayIndex++;
            const currentProgram = state.phase === 1 ? PROGRAM_PHASE_1 : PROGRAM_PHASE_2;
            
            if(state.dayIndex >= currentProgram.length) {
                state.dayIndex = 0;
                state.cycle++;
            }
            saveState();
            renderNav();
            renderWorkout();
        }

        function prevDay() {
            const currentProgram = state.phase === 1 ? PROGRAM_PHASE_1 : PROGRAM_PHASE_2;
            
            if (state.dayIndex > 0) {
                state.dayIndex--;
            } else if (state.cycle > 1) {
                state.cycle--;
                state.dayIndex = currentProgram.length - 1;
            } else {
                alert("SYSTEM ERROR: ARCHIVE EMPTY. CANNOT REVERT FURTHER.");
                return;
            }
            window.scrollTo(0,0);
            saveState();
            renderNav();
            renderWorkout();
        }

        function changeView(viewName) {
            if(viewName === 'settings') toggleSettings();
        }

    </script>
</body>
</html>
